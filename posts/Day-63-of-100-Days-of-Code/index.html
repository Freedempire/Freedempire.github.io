<!DOCTYPE html><html class="hide-aside" lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Day 63 of 100 Days of Code | FREEDEMPIRE | 自由帝國</title><meta name="author" content="Freer"><meta name="copyright" content="Freer"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Databases and with SQLite and SQLAlchemy">
<meta property="og:type" content="article">
<meta property="og:title" content="Day 63 of 100 Days of Code">
<meta property="og:url" content="https://freedempire.github.io/posts/Day-63-of-100-Days-of-Code/index.html">
<meta property="og:site_name" content="FREEDEMPIRE | 自由帝國">
<meta property="og:description" content="Databases and with SQLite and SQLAlchemy">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.ibb.co/jwVR5v0/100-days-of-code.jpg">
<meta property="article:published_time" content="2023-07-22T09:19:01.000Z">
<meta property="article:modified_time" content="2023-07-23T09:08:15.086Z">
<meta property="article:author" content="Freer">
<meta property="article:tag" content="python">
<meta property="article:tag" content="web development">
<meta property="article:tag" content="flask">
<meta property="article:tag" content="backend">
<meta property="article:tag" content="sqlite">
<meta property="article:tag" content="sqlalchemy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.ibb.co/jwVR5v0/100-days-of-code.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://freedempire.github.io/posts/Day-63-of-100-Days-of-Code/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":50,"languages":{"author":"Author: Freer","link":"Link: ","source":"Source: FREEDEMPIRE | 自由帝國","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: false,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Day 63 of 100 Days of Code',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-07-23 19:08:15'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">30</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">73</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><span> Tags</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> Programming</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/programming/learning_logs/"><span> Learning Logs</span></a></li><li><a class="site-page child" href="/programming/projects/"><span> Projects</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/gallery/"><span> Gallery</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url('https://i.ibb.co/x1B8mMQ/abstract-background-01.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="FREEDEMPIRE | 自由帝國"><span class="site-name">FREEDEMPIRE | 自由帝國</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><span> Tags</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> Programming</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/programming/learning_logs/"><span> Learning Logs</span></a></li><li><a class="site-page child" href="/programming/projects/"><span> Projects</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/gallery/"><span> Gallery</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Day 63 of 100 Days of Code</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-07-22T09:19:01.000Z" title="Created 2023-07-22 19:19:01">2023-07-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-07-23T09:08:15.086Z" title="Updated 2023-07-23 19:08:15">2023-07-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/python/">python</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Day 63 of 100 Days of Code"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">Comments:</span><span class="disqus-comment-count"><a href="https://freedempire.github.io/posts/Day-63-of-100-Days-of-Code/#disqus_thread"><i class="fa-solid fa-spinner fa-spin"></i></a></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><style>
    #intro {
        text-align: center;
    }
    #intro .title {
        font-size: 1.5rem;
        font-weight: 700;
        color: rgb(31, 45, 61);
    }
    #intro .subtitle {
        font-size: 1.2rem;
        font-weight: 700;
        color: rgb(31, 45, 61);
    }
</style>

<div id="intro">
    <p class="title">Databases and with SQLite and SQLAlchemy</h2>
    <p class="subtitle">Learning Log: Day 63 of 100 Days of Code</h3>
    <p>GitHub Repo: <a target="_blank" rel="noopener" href="https://github.com/Freedempire/100_days_of_code.git">100_days_of_code</a></p>
</div>

<h2 id="SQLite"><a href="#SQLite" class="headerlink" title="SQLite"></a>SQLite</h2><p>SQLite is a C library that provides a lightweight disk-based database that doesn’t require a separate server process and allows accessing the database using a nonstandard variant of the SQL query language. Some applications can use SQLite for internal data storage. It’s also possible to <em>prototype</em> an application using SQLite and then port the code to a larger database such as <strong>PostgreSQL</strong> or <strong>Oracle</strong>.</p>
<h3 id="Tutorial"><a href="#Tutorial" class="headerlink" title="Tutorial"></a>Tutorial</h3><p>First, we need to create a new database and open a database connection to allow sqlite3 to work with it. Call <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.connect">sqlite3.connect()</a> to create a connection to the database <code>tutorial.db</code> in the current working directory, <em>implicitly</em> creating it if it does not exist:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line">con = sqlite3.connect(<span class="string">&quot;tutorial.db&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>The returned <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection">Connection</a> object con represents the connection to the on-disk database.</p>
<p>In order to execute SQL statements and fetch results from SQL queries, we will need to use a database cursor. Call <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection.cursor">con.cursor()</a> to create the <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Cursor">Cursor</a>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cur = con.cursor()</span><br></pre></td></tr></table></figure>

<p>For simplicity, we can just use column names in the table declaration – thanks to the <a target="_blank" rel="noopener" href="https://www.sqlite.org/flextypegood.html">flexible typing</a> feature of SQLite, specifying the data types is optional. Execute the <code>CREATE TABLE</code> statement by calling <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Cursor.execute">cur.execute(…)</a>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">&quot;CREATE TABLE movie(title, year, score)&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>We can verify that the new table has been created by querying the <code>sqlite_master</code> table built-in to SQLite, which should now contain an entry for the movie table definition (see <a target="_blank" rel="noopener" href="https://www.sqlite.org/schematab.html">The Schema Table</a> for details). Execute that query by calling <code>cur.execute(...)</code>, assign the result to <code>res</code>, and call <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Cursor.fetchone">res.fetchone()</a> to fetch the resulting row:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; res = cur.execute(<span class="string">&quot;SELECT name FROM sqlite_master&quot;</span>)</span><br><span class="line">&gt;&gt;&gt; res.fetchone()</span><br><span class="line">(<span class="string">&#x27;movie&#x27;</span>,)</span><br><span class="line">&gt;&gt;&gt; res = cur.execute(<span class="string">&quot;SELECT name FROM sqlite_master WHERE name=&#x27;spam&#x27;&quot;</span>)</span><br><span class="line">&gt;&gt;&gt; res.fetchone() is None</span><br><span class="line">True</span><br></pre></td></tr></table></figure>

<p>Now, add two rows of data supplied as SQL literals by executing an <code>INSERT</code> statement, once again by calling <code>cur.execute(...)</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    INSERT INTO movie VALUES</span></span><br><span class="line"><span class="string">        (&#x27;Monty Python and the Holy Grail&#x27;, 1975, 8.2),</span></span><br><span class="line"><span class="string">        (&#x27;And Now for Something Completely Different&#x27;, 1971, 7.5)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>The <code>INSERT</code> statement implicitly opens a <em>transaction</em>, which needs to be committed before changes are saved in the database (see <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3-controlling-transactions">Transaction control</a> for details). Call <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection.commit">con.commit()</a> on the connection object to commit the transaction:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">con.commit()</span><br></pre></td></tr></table></figure>

<p>We can verify that the data was inserted correctly by executing a <code>SELECT</code> query. Use the now-familiar <code>cur.execute(...)</code> to assign the result to <code>res</code>, and call <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Cursor.fetchall">res.fetchall()</a> to return all resulting rows:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; res = cur.execute(<span class="string">&quot;SELECT score FROM movie&quot;</span>)</span><br><span class="line">&gt;&gt;&gt; res.fetchall()</span><br><span class="line">[(8.2,), (7.5,)]</span><br></pre></td></tr></table></figure>

<p>Now, insert three more rows by calling <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Cursor.executemany">cur.executemany(…)</a>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">data = [</span><br><span class="line">    (<span class="string">&quot;Monty Python Live at the Hollywood Bowl&quot;</span>, <span class="number">1982</span>, <span class="number">7.9</span>),</span><br><span class="line">    (<span class="string">&quot;Monty Python&#x27;s The Meaning of Life&quot;</span>, <span class="number">1983</span>, <span class="number">7.5</span>),</span><br><span class="line">    (<span class="string">&quot;Monty Python&#x27;s Life of Brian&quot;</span>, <span class="number">1979</span>, <span class="number">8.0</span>),</span><br><span class="line">]</span><br><span class="line">cur.executemany(<span class="string">&quot;INSERT INTO movie VALUES(?, ?, ?)&quot;</span>, data)</span><br><span class="line">con.commit()</span><br></pre></td></tr></table></figure>

<p>Notice that <code>?</code> placeholders are used to bind data to the query. <em>Always</em> use placeholders instead of string formatting to bind Python values to SQL statements, to avoid <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/SQL_injection">SQL injection attacks</a>.</p>
<p>We can verify that the new rows were inserted by executing a <code>SELECT</code> query, this time iterating over the results of the query:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="keyword">for</span> row <span class="keyword">in</span> cur.execute(<span class="string">&quot;SELECT year, title FROM movie ORDER BY year&quot;</span>):</span><br><span class="line">&gt;&gt;&gt;     <span class="built_in">print</span>(row)</span><br><span class="line">(1971, <span class="string">&#x27;And Now for Something Completely Different&#x27;</span>)</span><br><span class="line">(1975, <span class="string">&#x27;Monty Python and the Holy Grail&#x27;</span>)</span><br><span class="line">(1979, <span class="string">&quot;Monty Python&#x27;s Life of Brian&quot;</span>)</span><br><span class="line">(1982, <span class="string">&#x27;Monty Python Live at the Hollywood Bowl&#x27;</span>)</span><br><span class="line">(1983, <span class="string">&quot;Monty Python&#x27;s The Meaning of Life&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>Finally, verify that the database has been written to disk by calling <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection.close">con.close()</a> to close the existing connection, opening a new one, creating a new cursor, then querying the database:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; con.close()</span><br><span class="line">&gt;&gt;&gt; new_con = sqlite3.connect(<span class="string">&quot;tutorial.db&quot;</span>)</span><br><span class="line">&gt;&gt;&gt; new_cur = new_con.cursor()</span><br><span class="line">&gt;&gt;&gt; res = new_cur.execute(<span class="string">&quot;SELECT title, year FROM movie ORDER BY score DESC&quot;</span>)</span><br><span class="line">&gt;&gt;&gt; title, year = res.fetchone()</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(f<span class="string">&#x27;The highest scoring Monty Python movie is &#123;title!r&#125;, released in &#123;year&#125;&#x27;</span>)</span><br><span class="line">The highest scoring Monty Python movie is <span class="string">&#x27;Monty Python and the Holy Grail&#x27;</span>, released <span class="keyword">in</span> 1975</span><br></pre></td></tr></table></figure>

<p>The <code>!r</code> in the above f-string can be replace by calls to <code>repr()</code>. Similarly, <code>!s</code> can be replaced by calls to <code>str()</code> and <code>!a</code> by calls to <code>ascii()</code>.</p>
<h3 id="How-to-guides"><a href="#How-to-guides" class="headerlink" title="How-to guides"></a>How-to guides</h3><h4 id="How-to-use-connection-shortcut-methods"><a href="#How-to-use-connection-shortcut-methods" class="headerlink" title="How to use connection shortcut methods"></a>How to use connection shortcut methods</h4><p>Using the <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection.execute">execute()</a>, <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection.executemany">executemany()</a>, and <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection.executescript">executescript()</a> methods of the <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection">Connection</a> class, your code can be written more concisely because you don’t have to create the (often superfluous) <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Cursor">Cursor</a> objects explicitly. Instead, the Cursor objects are created <em>implicitly</em> and these shortcut methods <em>return the cursor objects</em>. This way, you can execute a <code>SELECT</code> statement and iterate over it directly using only a single call on the Connection object.</p>
<h4 id="How-to-use-the-connection-context-manager"><a href="#How-to-use-the-connection-context-manager" class="headerlink" title="How to use the connection context manager"></a>How to use the connection context manager</h4><p>A <code>Connection</code> object can be used as a context manager that automatically <em>commits</em> or <em>rolls back</em> open <em>transactions</em> when leaving the body of the context manager. If the body of the with statement finishes without exceptions, the transaction is committed. If this commit fails, or if the body of the with statement raises an uncaught exception, the transaction is rolled back.</p>
<p>If there is no open transaction upon leaving the body of the with statement, the context manager is a no-op (no operation).</p>
<p>Note The context manager neither implicitly opens a new transaction nor closes the connection.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">con = sqlite3.connect(<span class="string">&quot;:memory:&quot;</span>)</span><br><span class="line">con.execute(<span class="string">&quot;CREATE TABLE lang(id INTEGER PRIMARY KEY, name VARCHAR UNIQUE)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Successful, con.commit() is called automatically afterwards</span></span><br><span class="line"><span class="keyword">with</span> con:</span><br><span class="line">    con.execute(<span class="string">&quot;INSERT INTO lang(name) VALUES(?)&quot;</span>, (<span class="string">&quot;Python&quot;</span>,))</span><br><span class="line"></span><br><span class="line"><span class="comment"># con.rollback() is called after the with block finishes with an exception,</span></span><br><span class="line"><span class="comment"># the exception is still raised and must be caught</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">with</span> con:</span><br><span class="line">        con.execute(<span class="string">&quot;INSERT INTO lang(name) VALUES(?)&quot;</span>, (<span class="string">&quot;Python&quot;</span>,))</span><br><span class="line"><span class="keyword">except</span> sqlite3.IntegrityError:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;couldn&#x27;t add Python twice&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Connection object used as context manager only commits or rollbacks transactions,</span></span><br><span class="line"><span class="comment"># so the connection object should be closed manually</span></span><br><span class="line">con.close()</span><br></pre></td></tr></table></figure>

<h4 id="How-to-use-placeholders-to-bind-values-in-SQL-queries"><a href="#How-to-use-placeholders-to-bind-values-in-SQL-queries" class="headerlink" title="How to use placeholders to bind values in SQL queries"></a>How to use placeholders to bind values in SQL queries</h4><p>SQL operations usually need to use values from Python variables. However, beware of using Python’s string operations to assemble queries, as they are vulnerable to <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/SQL_injection">SQL injection attacks</a>. For example, an attacker can simply close the single quote and inject OR TRUE to select all rows:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="comment"># Never do this -- insecure!</span></span><br><span class="line">&gt;&gt;&gt; symbol = input()</span><br><span class="line"><span class="string">&#x27; OR TRUE; --</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; sql = &quot;SELECT * FROM stocks WHERE symbol = &#x27;</span>%s<span class="string">&#x27;&quot; % symbol</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; print(sql)</span></span><br><span class="line"><span class="string">SELECT * FROM stocks WHERE symbol = &#x27;</span><span class="string">&#x27; OR TRUE; --&#x27;</span></span><br><span class="line">&gt;&gt;&gt; cur.execute(sql)</span><br></pre></td></tr></table></figure>

<p>Instead, use the DB-API’s parameter substitution. To insert a variable into a query string, use a <em>placeholder</em> in the string, and substitute the actual values into the query by providing them as a tuple of values to the second argument of the cursor’s <code>execute()</code> method.</p>
<p>An SQL statement may use one of two kinds of placeholders: <strong>question marks</strong> (qmark style) or <strong>named placeholders</strong> (named style). For the qmark style, parameters must be a <em>sequence</em> whose length must match the number of placeholders, or a <code>ProgrammingError</code> is raised. For the named style, parameters should be an instance of a <em>dict</em> (or a subclass), which must contain keys for all named parameters; any extra items are <em>ignored</em>. Here’s an example of both styles:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">con = sqlite3.connect(<span class="string">&quot;:memory:&quot;</span>)</span><br><span class="line">cur = con.execute(<span class="string">&quot;CREATE TABLE lang(name, first_appeared)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># This is the named style used with executemany():</span></span><br><span class="line">data = (</span><br><span class="line">    &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;C&quot;</span>, <span class="string">&quot;year&quot;</span>: <span class="number">1972</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;Fortran&quot;</span>, <span class="string">&quot;year&quot;</span>: <span class="number">1957</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;Python&quot;</span>, <span class="string">&quot;year&quot;</span>: <span class="number">1991</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;Go&quot;</span>, <span class="string">&quot;year&quot;</span>: <span class="number">2009</span>&#125;,</span><br><span class="line">)</span><br><span class="line">cur.executemany(<span class="string">&quot;INSERT INTO lang VALUES(:name, :year)&quot;</span>, data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># This is the qmark style used in a SELECT query:</span></span><br><span class="line">params = (<span class="number">1972</span>,)</span><br><span class="line">cur.execute(<span class="string">&quot;SELECT * FROM lang WHERE first_appeared = ?&quot;</span>, params)</span><br><span class="line"><span class="built_in">print</span>(cur.fetchall())</span><br></pre></td></tr></table></figure>

<h4 id="How-to-create-and-use-row-factories"><a href="#How-to-create-and-use-row-factories" class="headerlink" title="How to create and use row factories"></a>How to create and use row factories</h4><p>By default, sqlite3 represents each row as a tuple. If a tuple does not suit your needs, you can use the <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Row">sqlite3.Row</a> class or a custom <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Cursor.row_factory">row_factory</a>.</p>
<p>While <code>row_factory</code> exists as an attribute both on the <code>Cursor</code> and the <code>Connection</code>, it is recommended to set <code>Connection.row_factory</code>, so all cursors created from the connection will use the same row factory.</p>
<p><code>Row</code> provides indexed and case-insensitive named access to columns, with minimal memory overhead and performance impact over a tuple. To use <code>Row</code> as a row factory, assign it to the row_factory attribute:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; con = sqlite3.connect(<span class="string">&quot;:memory:&quot;</span>)</span><br><span class="line">&gt;&gt;&gt; con.row_factory = sqlite3.Row</span><br></pre></td></tr></table></figure>

<p>Queries now return Row objects:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; res = con.execute(<span class="string">&quot;SELECT &#x27;Earth&#x27; AS name, 6378 AS radius&quot;</span>)</span><br><span class="line">&gt;&gt;&gt; row = res.fetchone()</span><br><span class="line">&gt;&gt;&gt; row.keys()</span><br><span class="line">[<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;radius&#x27;</span>]</span><br><span class="line">&gt;&gt;&gt; row[0]         <span class="comment"># Access by index.</span></span><br><span class="line"><span class="string">&#x27;Earth&#x27;</span></span><br><span class="line">&gt;&gt;&gt; row[<span class="string">&quot;name&quot;</span>]    <span class="comment"># Access by name.</span></span><br><span class="line"><span class="string">&#x27;Earth&#x27;</span></span><br><span class="line">&gt;&gt;&gt; row[<span class="string">&quot;RADIUS&quot;</span>]  <span class="comment"># Column names are case-insensitive.</span></span><br><span class="line">6378</span><br></pre></td></tr></table></figure>

<p>You can create a custom <code>row_factory</code> that returns each row as a dict, with column names mapped to values:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dict_factory</span>(<span class="params">cursor, row</span>):</span><br><span class="line">    fields = [column[<span class="number">0</span>] <span class="keyword">for</span> column <span class="keyword">in</span> cursor.description]</span><br><span class="line">    <span class="keyword">return</span> &#123;key: value <span class="keyword">for</span> key, value <span class="keyword">in</span> <span class="built_in">zip</span>(fields, row)&#125;</span><br></pre></td></tr></table></figure>

<p>Using it, queries now return a dict instead of a tuple:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; con = sqlite3.connect(<span class="string">&quot;:memory:&quot;</span>)</span><br><span class="line">&gt;&gt;&gt; con.row_factory = dict_factory</span><br><span class="line">&gt;&gt;&gt; <span class="keyword">for</span> row <span class="keyword">in</span> con.execute(<span class="string">&quot;SELECT 1 AS a, 2 AS b&quot;</span>):</span><br><span class="line">...     <span class="built_in">print</span>(row)</span><br><span class="line">&#123;<span class="string">&#x27;a&#x27;</span>: 1, <span class="string">&#x27;b&#x27;</span>: 2&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Standard-commands"><a href="#Standard-commands" class="headerlink" title="Standard commands"></a>Standard commands</h3><p><a target="_blank" rel="noopener" href="https://www.codecademy.com/article/sql-commands">SQL Commands</a></p>
<h4 id="Data-definition"><a href="#Data-definition" class="headerlink" title="Data definition"></a>Data definition</h4><ul>
<li><a target="_blank" rel="noopener" href="https://www.sqlite.org/lang_createtable.html">CREATE</a></li>
<li><a target="_blank" rel="noopener" href="https://www.sqlite.org/lang_altertable.html">ALTER</a></li>
<li><a target="_blank" rel="noopener" href="https://www.sqlite.org/lang_droptable.html">DROP</a></li>
</ul>
<h4 id="Data-manipulation"><a href="#Data-manipulation" class="headerlink" title="Data manipulation"></a>Data manipulation</h4><ul>
<li><a target="_blank" rel="noopener" href="https://www.sqlite.org/lang_insert.html">INSERT</a></li>
<li><a target="_blank" rel="noopener" href="https://www.sqlite.org/lang_update.html">UPDATE</a></li>
<li><a target="_blank" rel="noopener" href="https://www.sqlite.org/lang_delete.html">DELETE</a></li>
</ul>
<h4 id="Data-query"><a href="#Data-query" class="headerlink" title="Data query"></a>Data query</h4><ul>
<li><a target="_blank" rel="noopener" href="https://www.sqlite.org/lang_select.html">SELECT</a></li>
</ul>
<h3 id="Datatypes-in-SQLite"><a href="#Datatypes-in-SQLite" class="headerlink" title="Datatypes in SQLite"></a>Datatypes in SQLite</h3><ul>
<li>NULL. The value is a NULL value.</li>
<li>INTEGER. The value is a signed integer, stored in 0, 1, 2, 3, 4, 6, or 8 bytes depending on the magnitude of the value.</li>
<li>REAL. The value is a floating point value, stored as an 8-byte IEEE floating point number.</li>
<li>TEXT. The value is a text string, stored using the database encoding (UTF-8, UTF-16BE or UTF-16LE).</li>
<li>BLOB. The value is a blob of data, stored exactly as it was input.</li>
</ul>
<h2 id="Flask-SQLAlchemy"><a href="#Flask-SQLAlchemy" class="headerlink" title="Flask-SQLAlchemy"></a>Flask-SQLAlchemy</h2><p><a target="_blank" rel="noopener" href="https://flask-sqlalchemy.palletsprojects.com/en/3.0.x/quickstart/">Flask-SQLAlchemy Documentation</a><br><a target="_blank" rel="noopener" href="https://docs.sqlalchemy.org/tutorial/index.html">SQLAlchemy Tutorial</a></p>
<p>Flask-SQLAlchemy simplifies using SQLAlchemy by automatically handling creating, using, and cleaning up the SQLAlchemy objects you’d normally work with. While it adds a few useful features, it still works like SQLAlchemy.</p>
<h3 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -U Flask-SQLAlchemy</span><br></pre></td></tr></table></figure>

<h3 id="Configure-the-extension"><a href="#Configure-the-extension" class="headerlink" title="Configure the extension"></a>Configure the extension</h3><p>The only required Flask app config is the <code>SQLALCHEMY_DATABASE_URI</code> key. That is a connection string that tells SQLAlchemy what database to connect to.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"></span><br><span class="line"><span class="comment"># create the extension</span></span><br><span class="line">db = SQLAlchemy()</span><br><span class="line"><span class="comment"># create the app</span></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="comment"># configure the SQLite database, relative to the app instance folder</span></span><br><span class="line">app.config[<span class="string">&quot;SQLALCHEMY_DATABASE_URI&quot;</span>] = <span class="string">&quot;sqlite:///project.db&quot;</span></span><br><span class="line"><span class="comment"># initialize the app with the extension</span></span><br><span class="line">db.init_app(app)</span><br></pre></td></tr></table></figure>

<p>The <code>db</code> object gives you access to the <code>db.Model</code> class to define models, and the <code>db.session</code> to execute queries.</p>
<h3 id="Define-models"><a href="#Define-models" class="headerlink" title="Define models"></a>Define models</h3><p>Subclass <code>db.Model</code> to define a model class. The <code>db</code> object makes the names in <code>sqlalchemy</code> and <code>sqlalchemy.orm</code> available for convenience, such as <code>db.Column</code>. The model will generate a table name by converting the CamelCase class name to snake_case.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(db.Model):</span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    username = db.Column(db.String, unique=<span class="literal">True</span>, nullable=<span class="literal">False</span>)</span><br><span class="line">    email = db.Column(db.String)</span><br></pre></td></tr></table></figure>

<h3 id="Create-the-tables"><a href="#Create-the-tables" class="headerlink" title="Create the tables"></a>Create the tables</h3><p>After all models and tables are defined, call <code>SQLAlchemy.create_all()</code> to create the table schema in the database. This requires an application context. Since you’re not in a request at this point, create one manually.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> app.app_context():</span><br><span class="line">    db.create_all()</span><br></pre></td></tr></table></figure>

<p>If you define models in other modules, you must import them before calling <code>create_all</code>, otherwise SQLAlchemy will not know about them.</p>
<p><code>create_all</code> does not update tables if they are already in the database. If you change a model’s columns, use a migration library like Alembic with Flask-Alembic or Flask-Migrate to generate migrations that update the database schema.</p>
<h3 id="Query-the-data"><a href="#Query-the-data" class="headerlink" title="Query the data"></a>Query the data</h3><p>Within a Flask view or CLI command, you can use <code>db.session</code> to execute queries and modify model data.</p>
<p>SQLAlchemy automatically defines an <code>__init__</code> method for each model that assigns any keyword arguments to corresponding database columns and other attributes.</p>
<p><code>db.session.add(obj)</code> adds an object to the session, to be inserted. Modifying an object’s attributes updates the object. <code>db.session.delete(obj)</code> deletes an object. Remember to call <code>db.session.commit()</code> after modifying, adding, or deleting any data.</p>
<p><code>db.session.execute(db.select(...))</code> constructs a query to select data from the database. Building queries is the main feature of SQLAlchemy, so you’ll want to read its <a target="_blank" rel="noopener" href="https://docs.sqlalchemy.org/tutorial/data_select.html">tutorial on select</a> to learn all about it. You’ll usually use the <code>Result.scalars()</code> method to get a list of results, or the <code>Result.scalar()</code> method to get a single result.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/users&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_list</span>():</span><br><span class="line">    users = db.session.execute(db.select(User).order_by(User.username)).scalars()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;user/list.html&quot;</span>, users=users)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/users/create&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_create</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        user = User(</span><br><span class="line">            username=request.form[<span class="string">&quot;username&quot;</span>],</span><br><span class="line">            email=request.form[<span class="string">&quot;email&quot;</span>],</span><br><span class="line">        )</span><br><span class="line">        db.session.add(user)</span><br><span class="line">        db.session.commit()</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;user_detail&quot;</span>, <span class="built_in">id</span>=user.<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;user/create.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/user/&lt;int:id&gt;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_detail</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    user = db.get_or_404(User, <span class="built_in">id</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;user/detail.html&quot;</span>, user=user)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/user/&lt;int:id&gt;/delete&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_delete</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    user = db.get_or_404(User, <span class="built_in">id</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        db.session.delete(user)</span><br><span class="line">        db.session.commit()</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;user_list&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;user/delete.html&quot;</span>, user=user)</span><br></pre></td></tr></table></figure>

<p>You may see uses of <code>Model.query</code> to build queries. This is an older interface for queries that is considered legacy in SQLAlchemy. Prefer using <code>db.session.execute(db.select(...))</code> instead.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://freedempire.github.io">Freer</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://freedempire.github.io/posts/Day-63-of-100-Days-of-Code/">https://freedempire.github.io/posts/Day-63-of-100-Days-of-Code/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/python/">python</a><a class="post-meta__tags" href="/tags/web-development/">web development</a><a class="post-meta__tags" href="/tags/flask/">flask</a><a class="post-meta__tags" href="/tags/backend/">backend</a><a class="post-meta__tags" href="/tags/sqlite/">sqlite</a><a class="post-meta__tags" href="/tags/sqlalchemy/">sqlalchemy</a></div><div class="post_share"><div class="social-share" data-image="https://i.ibb.co/jwVR5v0/100-days-of-code.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/Day-62-of-100-Days-of-Code/" title="Day 62 of 100 Days of Code"><img class="cover" src="https://i.ibb.co/jwVR5v0/100-days-of-code.jpg" onerror="onerror=null;src='/img/image_404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Day 62 of 100 Days of Code</div></div></a></div><div class="next-post pull-right"><a href="/posts/Day-64-of-100-Days-of-Code/" title="Day 64 of 100 Days of Code"><img class="cover" src="https://i.ibb.co/jwVR5v0/100-days-of-code.jpg" onerror="onerror=null;src='/img/image_404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Day 64 of 100 Days of Code</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/posts/Day-64-of-100-Days-of-Code/" title="Day 64 of 100 Days of Code"><img class="cover" src="https://i.ibb.co/jwVR5v0/100-days-of-code.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-23</div><div class="title">Day 64 of 100 Days of Code</div></div></a></div><div><a href="/posts/Day-54-of-100-Days-of-Code/" title="Day 54 of 100 Days of Code"><img class="cover" src="https://i.ibb.co/jwVR5v0/100-days-of-code.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-16</div><div class="title">Day 54 of 100 Days of Code</div></div></a></div><div><a href="/posts/Day-55-of-100-Days-of-Code/" title="Day 55 of 100 Days of Code"><img class="cover" src="https://i.ibb.co/jwVR5v0/100-days-of-code.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-17</div><div class="title">Day 55 of 100 Days of Code</div></div></a></div><div><a href="/posts/Day-56-of-100-Days-of-Code/" title="Day 56 of 100 Days of Code"><img class="cover" src="https://i.ibb.co/jwVR5v0/100-days-of-code.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-17</div><div class="title">Day 56 of 100 Days of Code</div></div></a></div><div><a href="/posts/Day-57-of-100-Days-of-Code/" title="Day 57 of 100 Days of Code"><img class="cover" src="https://i.ibb.co/jwVR5v0/100-days-of-code.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-18</div><div class="title">Day 57 of 100 Days of Code</div></div></a></div><div><a href="/posts/Day-59-of-100-Days-of-Code/" title="Day 59 of 100 Days of Code"><img class="cover" src="https://i.ibb.co/jwVR5v0/100-days-of-code.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-20</div><div class="title">Day 59 of 100 Days of Code</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#SQLite"><span class="toc-number">1.</span> <span class="toc-text">SQLite</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tutorial"><span class="toc-number">1.1.</span> <span class="toc-text">Tutorial</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-to-guides"><span class="toc-number">1.2.</span> <span class="toc-text">How-to guides</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#How-to-use-connection-shortcut-methods"><span class="toc-number">1.2.1.</span> <span class="toc-text">How to use connection shortcut methods</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#How-to-use-the-connection-context-manager"><span class="toc-number">1.2.2.</span> <span class="toc-text">How to use the connection context manager</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#How-to-use-placeholders-to-bind-values-in-SQL-queries"><span class="toc-number">1.2.3.</span> <span class="toc-text">How to use placeholders to bind values in SQL queries</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#How-to-create-and-use-row-factories"><span class="toc-number">1.2.4.</span> <span class="toc-text">How to create and use row factories</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Standard-commands"><span class="toc-number">1.3.</span> <span class="toc-text">Standard commands</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Data-definition"><span class="toc-number">1.3.1.</span> <span class="toc-text">Data definition</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Data-manipulation"><span class="toc-number">1.3.2.</span> <span class="toc-text">Data manipulation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Data-query"><span class="toc-number">1.3.3.</span> <span class="toc-text">Data query</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Datatypes-in-SQLite"><span class="toc-number">1.4.</span> <span class="toc-text">Datatypes in SQLite</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Flask-SQLAlchemy"><span class="toc-number">2.</span> <span class="toc-text">Flask-SQLAlchemy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Installation"><span class="toc-number">2.1.</span> <span class="toc-text">Installation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Configure-the-extension"><span class="toc-number">2.2.</span> <span class="toc-text">Configure the extension</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Define-models"><span class="toc-number">2.3.</span> <span class="toc-text">Define models</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Create-the-tables"><span class="toc-number">2.4.</span> <span class="toc-text">Create the tables</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Query-the-data"><span class="toc-number">2.5.</span> <span class="toc-text">Query the data</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/The-Complete-JavaScript-Course-Fundamentals/" title="The Complete JavaScript Course - Fundamentals">The Complete JavaScript Course - Fundamentals</a><time datetime="2023-08-16T10:23:14.000Z" title="Created 2023-08-16 20:23:14">2023-08-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/PDSA-Linked-Lists/" title="Python Data Structures and Algorithms - Linked Lists">Python Data Structures and Algorithms - Linked Lists</a><time datetime="2023-08-08T09:05:41.000Z" title="Created 2023-08-08 19:05:41">2023-08-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/PDSA-Pointers/" title="Python Data Structures and Algorithms - Pointers">Python Data Structures and Algorithms - Pointers</a><time datetime="2023-08-07T22:34:13.000Z" title="Created 2023-08-08 08:34:13">2023-08-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/PDSA-Big-O/" title="Python Data Structures and Algorithms - Big O">Python Data Structures and Algorithms - Big O</a><time datetime="2023-08-07T11:36:43.000Z" title="Created 2023-08-07 21:36:43">2023-08-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/Day-74-of-100-Days-of-Code/" title="Day 74 of 100 Days of Code">Day 74 of 100 Days of Code</a><time datetime="2023-08-05T07:36:58.000Z" title="Created 2023-08-05 17:36:58">2023-08-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/Day-73-of-100-Days-of-Code/" title="Day 73 of 100 Days of Code">Day 73 of 100 Days of Code</a><time datetime="2023-08-03T10:34:56.000Z" title="Created 2023-08-03 20:34:56">2023-08-03</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Freer</div><div class="footer_custom_text">Explore and shape the world and your own being with unfettered freedom.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    btf.addModeChange('mermaid', () => {
      window.runMermaid()
    })

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadDisqus () {
  const disqus_config = function () {
    this.page.url = 'https://freedempire.github.io/posts/Day-63-of-100-Days-of-Code/'
    this.page.identifier = '/posts/Day-63-of-100-Days-of-Code/'
    this.page.title = 'Day 63 of 100 Days of Code'
  }

  const disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  btf.addModeChange('disqus', disqusReset)

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://freedempire-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Disqus' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script><script>if (window.DISQUSWIDGETS === undefined) {
  var d = document, s = d.createElement('script');
  s.src = 'https://freedempire-github-io.disqus.com/count.js';
  s.id = 'dsq-count-scr';
  (d.head || d.body).appendChild(s);
} else {
  DISQUSWIDGETS.getCount({reset: true});
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>